{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nexport default function useAuth(code) {\n  _s();\n\n  const [accessToken, setAccessToken] = useState(\"\");\n  const [refreshToken, setRefreshToken] = useState();\n  const [expiresIn, setExpiresIn] = useState();\n  console.log(\"this is code\", code);\n  useEffect(() => {\n    axios.post('http://localhost:3001/login', {\n      code\n    }).then(res => {\n      setAccessToken(res.data.accessToken);\n      setRefreshToken(res.data.refreshToken);\n      setExpiresIn(res.data.expiresIn);\n      window.history.pushState({}, null, \"/\");\n    }).catch(err => {\n      window.location = '/';\n      console.log(err);\n    });\n  }, [code]);\n  useEffect(() => {\n    if (!refreshToken || !expiresIn) {\n      return;\n    }\n\n    const interval = setInterval(() => {\n      axios.post('http://localhost:3001/refresh', {\n        refreshToken\n      }).then(res => {\n        setAccessToken(res.data.accessToken);\n        setExpiresIn(res.data.expiresIn);\n      }).catch(err => {\n        window.location = '/';\n        console.log(err);\n      });\n    }, (expiresIn - 60) * 1000);\n    return () => clearInterval(interval);\n  }, [refreshToken, expiresIn]);\n  return accessToken;\n}\n\n_s(useAuth, \"uttEUUCn57auGtjJPQF/JO1Jask=\");","map":{"version":3,"sources":["/Users/antonyarreola/Documents/GitHub/spotify-clone/client/src/useAuth.js"],"names":["React","useState","useEffect","axios","useAuth","code","accessToken","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","console","log","post","then","res","data","window","history","pushState","catch","err","location","interval","setInterval","clearInterval"],"mappings":";;AAAA,OAAOA,KAAP,IAAcC,QAAd,EAAuBC,SAAvB,QAAuC,OAAvC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,eAAe,SAASC,OAAT,CAAiBC,IAAjB,EAAuB;AAAA;;AACnC,QAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCN,QAAQ,CAAC,EAAD,CAA9C;AACA,QAAM,CAACO,YAAD,EAAcC,eAAd,IAAiCR,QAAQ,EAA/C;AACA,QAAM,CAACS,SAAD,EAAWC,YAAX,IAA2BV,QAAQ,EAAzC;AAEDW,EAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA2BR,IAA3B;AACCH,EAAAA,SAAS,CAAC,MAAM;AAEbC,IAAAA,KAAK,CAACW,IAAN,CAAW,6BAAX,EAAyC;AACrCT,MAAAA;AADqC,KAAzC,EAEKU,IAFL,CAEUC,GAAG,IAAI;AACTT,MAAAA,cAAc,CAACS,GAAG,CAACC,IAAJ,CAASX,WAAV,CAAd;AACAG,MAAAA,eAAe,CAACO,GAAG,CAACC,IAAJ,CAAST,YAAV,CAAf;AACAG,MAAAA,YAAY,CAACK,GAAG,CAACC,IAAJ,CAASP,SAAV,CAAZ;AACAQ,MAAAA,MAAM,CAACC,OAAP,CAAeC,SAAf,CAAyB,EAAzB,EAA4B,IAA5B,EAAiC,GAAjC;AACH,KAPL,EAOOC,KAPP,CAOcC,GAAD,IAAS;AACdJ,MAAAA,MAAM,CAACK,QAAP,GAAkB,GAAlB;AACDX,MAAAA,OAAO,CAACC,GAAR,CAAYS,GAAZ;AACF,KAVL;AAYF,GAdQ,EAcP,CAACjB,IAAD,CAdO,CAAT;AAeAH,EAAAA,SAAS,CAAC,MAAM;AACZ,QAAG,CAACM,YAAD,IAAgB,CAACE,SAApB,EAA8B;AAAC;AAAO;;AACzC,UAAMc,QAAQ,GAAGC,WAAW,CAAC,MAAM;AAC9BtB,MAAAA,KAAK,CAACW,IAAN,CAAW,+BAAX,EAA2C;AAC5CN,QAAAA;AAD4C,OAA3C,EAEAO,IAFA,CAEKC,GAAG,IAAI;AACTT,QAAAA,cAAc,CAACS,GAAG,CAACC,IAAJ,CAASX,WAAV,CAAd;AAEAK,QAAAA,YAAY,CAACK,GAAG,CAACC,IAAJ,CAASP,SAAV,CAAZ;AAEH,OAPA,EAOEW,KAPF,CAOSC,GAAD,IAAS;AACdJ,QAAAA,MAAM,CAACK,QAAP,GAAkB,GAAlB;AACDX,QAAAA,OAAO,CAACC,GAAR,CAAYS,GAAZ;AACF,OAVA;AAWJ,KAZ2B,EAYzB,CAACZ,SAAS,GAAG,EAAb,IAAmB,IAZM,CAA5B;AAaA,WAAO,MAAMgB,aAAa,CAACF,QAAD,CAA1B;AAEA,GAjBQ,EAiBP,CAAChB,YAAD,EAAcE,SAAd,CAjBO,CAAT;AAkBA,SAAOJ,WAAP;AACF;;GAxCuBF,O","sourcesContent":["import React,{useState,useEffect} from 'react'\nimport axios from 'axios';\nexport default function useAuth(code) {\n   const [accessToken, setAccessToken] = useState(\"\");\n   const [refreshToken,setRefreshToken] = useState();\n   const [expiresIn,setExpiresIn] = useState();\n  \n  console.log(\"this is code\",code);\n   useEffect(() => {\n       \n      axios.post('http://localhost:3001/login',{\n          code,\n        }).then(res => {\n              setAccessToken(res.data.accessToken);\n              setRefreshToken(res.data.refreshToken);\n              setExpiresIn(res.data.expiresIn);\n              window.history.pushState({},null,\"/\")\n          }).catch((err) => {\n              window.location = '/';\n             console.log(err);\n          })\n      \n   },[code] )\n   useEffect(() => {\n       if(!refreshToken|| !expiresIn){return}\n    const interval = setInterval(( ) =>{\n         axios.post('http://localhost:3001/refresh',{\n        refreshToken,\n      }).then(res => {\n            setAccessToken(res.data.accessToken);\n           \n            setExpiresIn(res.data.expiresIn);\n            \n        }).catch((err) => {\n            window.location = '/';\n           console.log(err);\n        })\n    }, (expiresIn - 60) * 1000) \n    return () => clearInterval(interval);\n   \n   },[refreshToken,expiresIn])\n   return accessToken;\n}\n"]},"metadata":{},"sourceType":"module"}